# OS Lection 1
Через неделю в понедельник собрание по поводу тем
## Управление памятью в ОС
### Организация адресного пространства (линейная адресация)
ОС и драйвера могут находиться в ПЗУ, но чаще в ОЗУ.  Пример ОС в ПЗУ - BIOS. Однако, при загрузке она   загружается по определенным адресам ОЗУ. В этих случаях используется линейная адресация (число от 0 до последнего бита ОЗУ). Применяется в примитивных сценариях.  Одна из проблем такой организации - свопинг и последующая за ним фрагментация (пустые пространства в памяти), это было менее актуально во времена однозадачной DOS. Другая проблема - коллизии в памяти.

### Сегментная модель памяти

Применяется редко, избирательно. Разбиение на независимые участки, адресация идет он начала этого сегмента. Адрес становится двухкомпонентным (адрес сегмента и смещение). Адрес сегмента + смещение = линейный адрес. В таблице дескрипторов задаются атрибуты доступа сегмента (чтение, запись, исполнение). 

Преимущества:
* Изоляция адресных пространств.
* Безопасность, надежность
* Удобство для программиста.

Недостатки:
* Коллизия линейных адресов не гарантируется, но может происходить контроль и защита со стороны процессора.
* Могут происходить попытки доступа не к своему сегменту памяти.
* Ограничение размерами ОЗУ. (ограниченное количество сегментов)
* Сегменты могут быть разного размера и в разном месте. В том числе пересекаться линейными адресами. => Усложнение работы с памятью для ОС.

Селектор => Дескриптор[Базовый адрес, Предел, Другие поля] + Смещение = 32-х разрядный линейный адрес.

Селектор - некоторое число, индекс в таблице дескрипторов. По Селектору ос ищет запись в таблице дескрипторов, откуда получает информацию о базовом адресе. С помощью смещения можно получить линейный адрес. Раньше селектор совпадал с базовым адресом (DOS?). Линейный адрес совпадает с физическим адресом.

Сегментная модель используется до загрузки основной ОС? Т.к сегментная модель быстрее страничной, что критично для BIOS.

### Страничная модель памяти

В ЦПУ есть блок управления памятью (диспетчер памяти). Линейный адрес может не совпадать с физическим адресом, эту страничную трансляцию выполняет блок управления памятью. 

Преимущества:
* При этом для программиста память остается линейной, хотя линейные адреса могут быть разбросаны по разным физическим адресам.
* Легче избавиться от фрагментации памяти.
* Виртуальная память дешевая, можно выделять гигабайты памяти, однако пока они не используются, реальной взаимосвязи с физической памяти нет. Т.е. резервирование не связывает с физическими страницами.
* Страничная трансляция не совпадает с физическими, поэтому программы изолированы друг от друга. (хотя есть исключение CopyOnWrite)
* OS в том числе защищает саму себя.

Используется специальная структура - страничный каталог. Линейный адрес состоит из 3 частей : [10 бит, Индекс каталога][10, Индекс страницы][12, Смещение]. 12 бит - 4 Кб - размер страницы.

Справочный каталог > Таблица страниц > Страничный блок. Эти каталоги постоянно обновляются, этим занимается OS. 

Страничная подкачка позволяет использовать больше памяти, чем есть с помощью трансляции адресов на адреса на жестком диске.
